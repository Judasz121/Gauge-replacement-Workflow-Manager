@model ScheduleUserEditViewModel
@{
	ViewData["Title"] = "UserEdit";
	Layout = "~/Views/Shared/_Layout.cshtml";
}

<form method="post" asp-controller="Schedule" asp-action="UserEdit" enctype="multipart/form-data">
	<h1>Edycja przypisanych zadań dla @Model.User.FullName</h1> <button type="submit" class="btn btn-primary float-right title-btn btn-lg">Zapisz</button>
	@Html.HiddenFor(m => m.UserId)
	@Html.HiddenFor(m => m.AssignedJobs)
<span style="display:inline-block">
	@Html.ValidationMessageFor(m => m.AssignedJobs, null, new { @class = "text-danger " })
</span>
</form>

<hr />
<div class="row">
	<div class="col">
		<div class="card">
			<div class="card-header">
				Zadania przypisane
			</div>
			<div class="card-body">
				<ul id="userEditSortable-AssignedJobs" class="connectedSortable">
					@foreach (JobViewModel item in Model.User.Jobs)
					{
					<li id="job_@item.Id">
						<div class="card job-card">
							<div class="card-header">
								@Html.ActionLink(item.Name, "Details", "Job", new { id = item.Id }, new { @class = "object-link" })
							</div>
							<div class="card-body">
								<div class="row">
									<div class="col">
										Budynek
										<hr />
										@Html.ActionLink(item.Building.FullAddress, "Details", "Building", new { id = item.IdBuilding }, new { @class = "object-link" })
									</div>
									<div class="col">
										Przypisani
										<hr />
										@foreach (var user in item.Users)
										{
											@Html.ActionLink(user.FullName, "Details", "Building", new { id = user.Id }, new { @class = "object-link" })
											<br />
										}
									</div>
								</div>
							</div>
						</div>
					</li>
					}
				</ul>
			</div>
		</div>
	</div>
	<div class="col">
		<div class="card">
			<div class="card-header">
				Wszystkie zadania
			</div>
			<div class="card-body">
				<ul id="userEditSortable-AllJobs" class="connectedSortable">
					@foreach (JobViewModel item in Model.AllJobs)
					{
						<li id="job_@item.Id">
							<div class="card job-card">
								<div class="card-header">
									@Html.ActionLink(item.Name, "Details", "Job", new { id = item.Id }, new { @class = "object-link" })
								</div>
								<div class="card-body">
									<div class="row">
										<div class="col">
											Budynek
											<hr />
											@Html.ActionLink(item.Building.FullAddress, "Details", "Building", new { id = item.IdBuilding }, new { @class = "object-link" })
										</div>
										<div class="col">
											Przypisani
											<hr />
											@foreach (var user in item.Users)
											{
												@Html.ActionLink(user.FullName, "Details", "Building", new { id = user.Id }, new { @class = "object-link" })
												<br />
											}
										</div>
									</div>
								</div>
							</div>
						</li>
					}
				</ul>
			</div>
		</div>
	</div>
</div>

@*<div class="row" style=" margin-top: 10px;">
	<div class="col">
		<div class="card">
			<div class="card-header">
				Szczegóły zadania
			</div>
			<div class="card-body">

			</div>
		</div>
	</div>
</div>*@